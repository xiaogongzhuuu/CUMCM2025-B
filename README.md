# SiC/Si 外延层厚度测量分析项目

本项目采用红外干涉反射光谱法测量碳化硅(SiC)和硅(Si)外延层厚度，包含两种不同的分析方法和完整的数据处理流程。

## 📁 项目结构

```
├── B题.pdf                           # 题目说明文档
├── README.md                         # 本文档
├── 问题2/                            # 条纹间隔法厚度计算
│   ├── 代码/
│   │   ├── 附件1.py                 # SiC 10°入射角分析
│   │   └── 附件2.py                 # SiC 15°入射角分析
│   ├── 分析结果/
│   │   ├── 附件1/                   # 10°入射角结果
│   │   │   ├── 波长_折射率_附件1.xlsx
│   │   │   ├── 分析报告_附件1.txt
│   │   │   ├── 干涉条纹标记.png
│   │   │   ├── 厚度计算结果_附件1.txt
│   │   │   ├── 条纹间隔_附件1.xlsx
│   │   │   └── SiC_10度拟合.png
│   │   └── 附件2/                   # 15°入射角结果
│   │       ├── 波长_折射率_附件2.xlsx
│   │       ├── 分析报告_附件2.txt
│   │       ├── 干涉条纹标记.png
│   │       ├── 厚度计算结果_附件2.txt
│   │       └── 条纹间隔_附件2.xlsx
│   ├── 附件/
│   │   ├── 附件1.xlsx               # 10°入射角实验数据
│   │   └── 附件2.xlsx               # 15°入射角实验数据
│   └── 说明文档/
├── 问题3/                            # Airy干涉模型拟合法
│   ├── 代码/
│   │   ├── 附件1(修正).py           # SiC 10°入射角拟合
│   │   ├── 附件2(修正).py           # SiC 15°入射角拟合
│   │   ├── 附件3.py                 # Si 10°入射角拟合
│   │   └── 附件4.py                 # Si 15°入射角拟合
│   ├── 分析结果/
│   │   ├── 附件1(修正)/
│   │   ├── 附件2(修正)/
│   │   ├── 附件3/
│   │   └── 附件4/
│   ├── 附件/
│   │   ├── 附件1.xlsx               # SiC样品数据
│   │   ├── 附件2.xlsx               # SiC样品数据
│   │   ├── 附件3.xlsx               # Si样品数据
│   │   └── 附件4.xlsx               # Si样品数据
│   └── 说明文档/
```

## 🔬 分析方法对比

### 方法一：条纹间隔法（问题2）
- **适用样品**: SiC外延层
- **理论基础**: 菲涅尔反射公式 + Cauchy色散模型
- **计算公式**: `d = λ²/(2nₒcosθΔλ)`
- **核心代码**: [附件1.py](问题2/代码/附件1.py), [附件2.py](问题2/代码/附件2.py)

**Cauchy模型拟合结果**:
- 10°入射角: A=3.328, B=-24.69 μm², C=139.09 μm⁴ (R²=0.200)
- 15°入射角: A=3.322, B=-23.65 μm², C=135.76 μm⁴ (R²=0.210)

**厚度测量结果**:
- 10°入射角: **14.42 μm** (条纹间隔 0.1884 μm)
- 15°入射角: **14.73 μm** (条纹间隔 0.1933 μm)

### 方法二：Airy干涉拟合法（问题3）
- **适用样品**: SiC和Si外延层
- **理论基础**: 多光束Airy干涉公式 + Cauchy色散模型
- **拟合参数**: 厚度d、折射率参数A、B、C
- **核心代码**: [附件1(修正).py](问题3/代码/附件1(修正).py), [附件2(修正).py](问题3/代码/附件2(修正).py), [附件3.py](问题3/代码/附件3.py), [附件4.py](问题3/代码/附件4.py)

**SiC样品拟合结果**:
- 10°入射角: **1.87 μm** (R²=0.257, RMSE=0.152)
- 15°入射角: **1.84 μm** (R²=0.261, RMSE=0.163)

**Si样品拟合结果**:
- 10°入射角: **2.29 μm** (R²=-0.093, RMSE=0.140)
- 15°入射角: **2.36 μm** (R²=-0.229, RMSE=0.166)

## 🚀 快速开始

### 1. 环境配置
```bash
pip install numpy pandas scipy matplotlib openpyxl
```

### 2. 运行分析

**条纹间隔法分析**:
```bash
cd 问题2/代码/
python 附件1.py  # SiC 10°分析
python 附件2.py  # SiC 15°分析
```

**Airy拟合法分析**:
```bash
cd 问题3/代码/
python 附件1\(修正\).py  # SiC 10°拟合
python 附件2\(修正\).py  # SiC 15°拟合
python 附件3.py          # Si 10°拟合
python 附件4.py          # Si 15°拟合
```

## 📊 输出文件说明

每个分析程序会自动生成：

- **📈 拟合图片**: 实验数据vs拟合曲线对比
- **📋 Excel表格**: 详细的波长-折射率-反射率数据
- **📄 分析报告**: 拟合参数、质量评估(R²、RMSE)
- **🔍 条纹标记图**: 干涉峰识别和间隔计算

## 🧮 核心物理模型

### Cauchy色散模型
```python
n(λ) = A + B/λ² + C/λ⁴
```

### Airy干涉反射率
```python
R = (r₀₁² + r₁₂² + 2|r₀₁r₁₂|cos(2δ)) / (1 + (r₀₁r₁₂)² + 2|r₀₁r₁₂|cos(2δ))
```
其中 `δ = (2π/λ)n₁d cosθ₁`

### 厚度计算公式（条纹间隔法）
```python
d = λ²/(2n cosθ Δλ)
```

## 📋 详细结果总结

| 样品 | 入射角 | 方法 | 厚度(μm) | 拟合质量(R²) | RMSE | 条纹间隔(μm) |
|------|--------|------|----------|-------------|------|--------------|
| SiC  | 10°    | 条纹间隔法 | **14.42** | 0.200 | 0.688 | 0.1884 |
| SiC  | 15°    | 条纹间隔法 | **14.73** | 0.210 | 0.625 | 0.1933 |
| SiC  | 10°    | Airy拟合 | **1.87** | 0.257 | 0.152 | - |
| SiC  | 15°    | Airy拟合 | **1.84** | 0.261 | 0.163 | - |
| Si   | 10°    | Airy拟合 | **2.29** | -0.093⚠️ | 0.140 | 0.1606 |
| Si   | 15°    | Airy拟合 | **2.36** | -0.229⚠️ | 0.166 | 0.1691 |

### Cauchy模型参数对比

| 样品 | 入射角 | 方法 | A | B (μm²) | C (μm⁴) |
|------|--------|------|---|---------|---------|
| SiC  | 10°    | 条纹间隔法 | 3.328 | -24.69 | 139.09 |
| SiC  | 15°    | 条纹间隔法 | 3.322 | -23.65 | 135.76 |
| SiC  | 10°    | Airy拟合 | 3.381 | -9.56 | 0.42 |
| SiC  | 15°    | Airy拟合 | 3.461 | -10.26 | 3.57 |
| Si   | 10°    | Airy拟合 | 3.513 | -4.78 | 2.15 |
| Si   | 15°    | Airy拟合 | 3.376 | 0.011 | -6.64×10⁻⁴ |

## ⚠️ 重要发现与注意事项

### 1. 厚度测量结果分析
- **SiC样品**: 两种方法存在显著差异（~15μm vs ~2μm）
- **方法一（条纹间隔法）**: 结果相对稳定，角度依赖性小
- **方法二（Airy拟合法）**: SiC样品拟合质量较好，Si样品拟合失败

### 2. 拟合质量评估
- **优秀拟合**: SiC样品的Airy拟合 (R²≈0.26)
- **拟合失败**: Si样品的Airy拟合 (R²<0, 模型不适用)
- **原因分析**: Si样品可能需要更复杂的光学模型

### 3. 数据格式要求
- Excel文件第一列为波数(cm⁻¹)，第二列为反射率(%)
- 确保相对路径正确，程序会自动创建输出目录
- 支持中文字体显示，图表清晰美观

## 🔧 技术特点

- ✅ 基于严格光学理论（菲涅尔反射、Airy干涉）
- ✅ 自动噪声滤波和数据预处理（Savitzky-Golay滤波）
- ✅ 完整的拟合质量评估体系（R²、RMSE）
- ✅ 自动化结果输出和可视化
- ✅ 支持不同入射角和材料类型
- ✅ 智能干涉条纹识别算法

## 📞 技术支持

如遇到问题，请检查：
1. Python依赖包是否完整安装
2. Excel数据文件路径和格式是否正确  
3. 输出目录是否有写入权限
4. 对于Si样品，考虑使用其他光学模型

---
*本项目用于SiC/Si外延层厚度的精密测量分析，适用于半导体器件表征和质量控制。结果表明条纹间隔法对SiC外延层测量更为可靠。*