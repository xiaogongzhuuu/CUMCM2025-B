# SiC 15° 入射角外延层厚度计算

## 研究目的
在碳化硅 (SiC) 外延层厚度测量中，红外干涉法是一种常用的非破坏性手段。由于外延层与衬底之间存在折射率差异，在一定入射角下会产生干涉条纹。通过提取条纹间隔并结合色散模型，可以反推出外延层厚度。本文以 **15° 入射角实验数据** 为例，基于 **Cauchy+Drude 模型** 拟合折射率并进行厚度计算。

## 数学模型与物理基础

### 菲涅尔反射率
在入射角 $\theta_i$ 下，反射率由菲涅尔公式计算：

$$
R = \frac{1}{2}\left( 
\left|\frac{\cos\theta_i - n \cos\theta_t}{\cos\theta_i + n \cos\theta_t}\right|^2 
+ 
\left|\frac{n\cos\theta_i - \cos\theta_t}{n\cos\theta_i + \cos\theta_t}\right|^2 
\right)
$$

其中，折射角 $\theta_t$ 由 Snell 定律：

$$
\sin\theta_t = \frac{\sin\theta_i}{n}.
$$

### 折射率模型：Cauchy+Drude
外延层折射率 $n(\lambda)$ 的平方形式为：

$$
n^2(\lambda) = \left(A + \frac{B}{\lambda^2} + \frac{C}{\lambda^4}\right)^2 - \frac{Ne^2}{\varepsilon_0 m^\ast \omega^2},
$$

其中：
- $(A, B, C)$ 为 Cauchy 色散系数；
- $N$ 为自由载流子浓度；
- Drude 模型部分描述了自由电子对红外折射率的修正。

### 厚度公式
由干涉条件可得外延层厚度：

$$
d = \frac{\lambda \, (\lambda + \Delta \lambda)}{2 \, n(\lambda) \cos\theta_t \, \Delta \lambda}
$$

其中 $\lambda$ 为中心条纹波长，$\Delta \lambda$ 为平均条纹间隔。

## 程序实现步骤

1. **数据读取与预处理**  
   从 `附件2.xlsx` 读取实验反射率数据；转换波数为波长（μm）；使用 Savitzky–Golay 滤波器平滑曲线，抑制高频噪声。

2. **折射率反演与拟合**  
   根据菲涅尔公式，从实验反射率反演折射率；对有效数据区间，拟合 Cauchy 模型参数 $(A, B, C)$；在此基础上，通过最小化实验反射率与模型反射率之间的误差，反演最佳载流子浓度 $N$，得到完整的 Cauchy+Drude 模型。

3. **条纹提取与厚度计算**  
   使用 `find_peaks` 提取干涉峰位置；计算相邻条纹间隔 $\Delta \lambda$；选择中间条纹波长作为代表值，计算折射率 $n(\lambda)$ 与折射角 $\theta_t$；利用严格公式计算厚度 $d$。

4. **结果输出**  
   程序自动生成：
   - `波长_折射率_15度.xlsx`：拟合折射率数据；
   - `条纹间隔_15度.xlsx`：干涉条纹波长与间隔；
   - `厚度计算结果_15度.txt`：外延层厚度及条纹参数；
   - `SiC_15度拟合.png`：拟合结果可视化。

## 结果示例

- **拟合参数 (Cauchy 模型)**：  
  $A = 3.3278,\; B = -24.6992 \,\mu m^2,\; C = 139.1328 \,\mu m^4$。

- **拟合质量**：  
  $R^2 = -0.3135,\; RMSE = 0.8813$。

- **厚度计算**：  

  $$
  d \approx 14.7 \,\mu m, \quad
  \Delta \lambda \approx 0.19 \,\mu m, \quad
  \lambda \approx 3.48 \,\mu m, \quad
  n \approx 2.18
  $$

## 结论
相较于单一的 Cauchy 模型，Cauchy+Drude 模型能更好地描述掺杂 SiC 外延层在红外波段的折射率变化。实验结果验证了该方法在 15° 入射角条件下的适用性，厚度计算结果具有较高可靠性。
