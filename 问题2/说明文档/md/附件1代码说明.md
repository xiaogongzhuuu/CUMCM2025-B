# SiC 外延层厚度计算程序说明

## 研究背景
碳化硅 (SiC) 外延层的厚度是决定器件性能的重要参数之一。常用的红外干涉法利用外延层与衬底界面反射形成的干涉条纹，通过分析干涉条纹间隔与折射率的关系，建立厚度数学模型并计算。  

然而，SiC 外延层的折射率不是常数，它与波长以及掺杂载流子浓度相关。因此，在传统 Cauchy 色散模型基础上，需要引入 Drude 模型修正，以反映自由载流子对折射率的影响。本文采用 **Cauchy+Drude 联合模型** 来拟合折射率并计算厚度。  

## 数学模型

### 菲涅尔反射率
在入射角 $\theta_i$ 下，反射率由菲涅尔公式给出：

$$
R = \frac{1}{2}\left( 
\left|\frac{\cos\theta_i - n \cos\theta_t}{\cos\theta_i + n \cos\theta_t}\right|^2 
+ 
\left|\frac{n\cos\theta_i - \cos\theta_t}{n\cos\theta_i + \cos\theta_t}\right|^2 
\right),
$$

其中 $\theta_t$ 由 Snell 定律计算：

$$
\sin\theta_t = \frac{\sin\theta_i}{n}.
$$

### 折射率模型 (Cauchy+Drude)
折射率的平方写作：

$$
n^2(\lambda) = \left(A + \frac{B}{\lambda^2} + \frac{C}{\lambda^4}\right)^2 - \frac{Ne^2}{\varepsilon_0 m^\ast \omega^2},
$$

其中：
- 第一项为 **Cauchy 模型**，描述无掺杂情况下的色散；
- 第二项为 **Drude 修正项**，考虑自由载流子浓度 $N$ 对红外折射率的影响。  

### 厚度计算公式 (近似)
根据干涉条件，相邻条纹间隔 $\Delta \lambda$ 与厚度 $d$ 的关系为：

$$
d \approx \frac{\lambda^2}{2 n(\lambda) \cos\theta_t \, \Delta \lambda},
$$

其中 $\lambda$ 取条纹的中值波长。  

## 程序实现步骤

1. **数据读取与预处理**  
   使用 `pandas.read_excel()` 读取实验反射率光谱，并利用 `savgol_filter` 进行噪声滤波；波数转换为波长 (μm)。  

2. **折射率反演与拟合**  
   利用菲涅尔公式与数值优化 (`minimize_scalar`) 从反射率反演折射率；  
   在有效范围内拟合 Cauchy 参数 $(A, B, C)$；  
   引入 Drude 模型，反演出最佳自由载流子浓度 $N$。  

3. **条纹提取与厚度计算**  
   使用 `find_peaks` 提取光谱干涉峰位，计算相邻条纹波长间隔 $\Delta \lambda$；  
   取中值波长 $\lambda_{\text{center}}$，代入折射率模型与干涉公式计算外延层厚度。  

4. **结果输出**  
   输出 Excel 表格与 txt 文件，包括：  
   - 折射率与波长表格：`波长_折射率_10度.xlsx`  
   - 条纹位置与条纹间隔表格：`条纹间隔_10度.xlsx`  
   - 厚度结果：`厚度计算结果_10度.txt`  
   并绘制拟合结果图像。  

## 输出结果示例

程序输出的典型
